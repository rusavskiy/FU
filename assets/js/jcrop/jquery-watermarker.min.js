(function(c){c.Watermarker=function(d,g){function q(){e.width(f.width());e.height(f.height());var a=n(l.css("borderLeftWidth")),c=n(l.css("borderRightWidth")),b=n(l.css("borderTopWidth")),d=n(l.css("borderBottomWidth"));l.width(f.width()-a-c);l.height(f.height()-b-d)}function n(a){return parseInt(a.replace("px",""))}function m(){var c=r(e),b=r(s);a.onChange({x:c[0]-b[0],y:c[1]-b[1],w:e.width(),h:e.height(),opacity:a.opacity})}function r(a){a=c(a).offset();return[a.left,a.top]}"object"!==typeof d&&
(d=c(d)[0]);"object"!==typeof g&&(g={});var a={watermark_img:"watermark.png",opacity:1,opacitySlider:null,x:null,y:null,w:null,h:null,position:null,onChange:function(){},onSelect:function(){}};(function(b){"object"!=typeof b&&(b={});a=c.extend(a,b);"function"!==typeof a.onChange&&(a.onChange=function(){});"function"!==typeof a.onSelect&&(a.onSelect=function(){})})(g);var b=c(d),s=c("<div />").width(b.width()).height(b.height()).css({position:"relative"}).insertAfter(b);s.append(b);var f=c("<div />").resizable({resize:function(a,
b){q();m()},containment:"parent"}).draggable({drag:function(a,b){m()},containment:"parent"}).css({position:"absolute"}).insertAfter(b),l=c("<div />").addClass("watermark").css({position:"absolute","z-index":1});f.append(l);var e=c("<img />").attr("src",a.watermark_img).addClass("watermark").css({position:"absolute","z-index":2});f.append(e);null!==a.opacitySlider&&a.opacitySlider.slider({min:0,max:100,value:100*a.opacity,slide:function(b,c){a.opacity=c.value/100;f.css({opacity:a.opacity,filter:"alpha(opacity="+
100*a.opacity+")"});m()}});var h=Math.round(b.width()/2-e.width()/2),k=Math.round(b.height()/2-e.height()/2),p=b.height()-e.height(),b=b.width()-e.width();if(null!=a.x&&null!=a.y)h=a.x,k=a.y;else if(null!=a.position)switch(a.position){case "topleft":k=h=0;break;case "topcenter":k=0;break;case "topright":h=b;k=0;break;case "centerleft":h=0;break;case "centerright":h=b;break;case "bottomleft":h=0;k=p;break;case "bottomcenter":k=p;break;case "bottomright":h=b,k=p}f.css({top:k+"px",left:h+"px"});f.width(null==
a.w?e.width():a.w);f.height(null==a.h?e.height():a.h);q();f.css({opacity:a.opacity,filter:"alpha(opacity="+100*a.opacity+")"});m()};c.fn.Watermarker=function(d){function g(g){var n=d.useImg||g.src,m=new Image;m.onload=function(){c.Watermarker(g,d)};m.src=n}"object"!==typeof d&&(d={});this.each(function(){if(c(this).data("Watermarker")){if("api"==d)return c(this).data("Watermarker");c(this).data("Watermarker").setOptions(d)}else g(this)});return this}})(jQuery);
